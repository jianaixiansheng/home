{% load static %}
<!DOCTYPE html>
{#<html lang="en">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <title>ajax登录页面</title>#}
{#    <script src="/login/static/js/jquery-1.12.4.min.js"></script>#}
{#    <script src="{% static 'js/jquery-1.12.4.min.js' %}"></script>#}
{#</head>#}
{#    <script>#}
{#        $(function () {#}
{#            $('#btnLogin').click(function () {#}
{#                // 获取手机号#}
{#                user_tel = $("#user_tel").val();#}
{#                // 发起post ajax请求 /login_ajax_check,携带用户名和密码#}
{#                $.ajax({#}
{#                    "url":'{% url 'login_ajax' %}',#}
{#                    "type":'post',#}
{#                    "data":{'user_tel':user_tel}#}
{#                }).success(function (data) {#}
{#                    // 注册成功 {'res':1}#}
{#                    // 注册失败 {'res':0}#}
{#                    if (data.res == 0){#}
{#                        $("#errmsg").show().html("手机号已存在");#}
{#                        alert("手机号已存在")#}
{#                    }#}
{#                    else{#}
{#                        // 跳转到首页#}
{#                        location.href ='/index'#}
{#                    }#}
{#                })#}
{#            })#}
{#        })#}
{#        function change_code() {#}
{#            var img = document.getElementsByTagName("img")[0];#}
{#            img.src='{% url 'generate_code' %}?'+new Date().getTime()#}
{##}
{#        }#}
{#    </script>#}
{#    <script>#}
{#    function get_code() {#}
{#        user_tel = $("#user_tel").val();#}
{#        $.post('/login/get_phone_code/',{'user_tel':user_tel},function (data) {#}
{#            alert(typeof data)#}
{#           if (data.Message=="OK"){#}
{#               alert('验证码已经发送到您的手机，请注意查收！');#}
{#               frm_login.verify_code.focus()#}
{#           }#}
{#        },"json")#}
{##}
{#    }#}
{#    </script>#}


{#<body style="text-align: center" onload="frm_login.user_tel.focus()">#}
{#<div>#}
{#<form name="frm_login" method="post" action="/templates/login/login"></form>#}
{#    {% csrf_token %}#}
{#    <p>请输入手机号: <input type="tel" id="user_tel" name="user_tel" pattern="^(0|86|17951)?(13[0-9]|15[012356789]|17[0678]|18[0-9]|14[57])[0-9]{8}"><input#}
{#            type="button" value="发送验证码" onclick="get_code()"></p>#}
{#    <p>{{ errmsg }}</p>#}
{#    <p>请证明你不是机器人：<input type="text" name="login" /><img src="{% url "generate_code" %}" alt="" width="75" height="30" onclick="change_code()" style="cursor: pointer"></p>#}
{#    <p>{{ code_error }}</p>#}
{#    <input type= "button" id="btnLogin" value="登录">#}
{#    <div id="errmsg"></div>#}
{#</div>#}
{#</body>#}
{#</html>#}


##################################################8.2改动正确后###########################################################

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登陆页面</title>
</head>
    <script src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
<script>
    function click_login() {
        $.post(
            "{% url 'login:login_ajax' %}",
            {'user_tel':login_form.user_tel.value,'yzm':login_form.yzm.value},
            function (data) {
                if (data.res == 1){
                    location.href = '{% url "index" %}'
                }if(data.res == 0){
                    alert('账号或密码错误')
                }if(data.res == 2){
                    alert("验证码输入不正确")
                }
            }
        )
    }
</script>
<script>
    function change_code() {
            var img = document.getElementsByTagName("img")[0];
            img.src='/login/verify_code?'+new Date().getTime()
        }
</script>

<body style="text-align: center" onload="login_form.username.focus()">
<form method="post" id="login_form">
    <p>请输入手机号:<input type="text" name="user_tel"></p>
    请证明你不是机器人:<input type="text" name="yzm"><div style="margin-top: -24px;margin-left: 365px"><img src="{% url 'generate_code' %}" width="100" height="25" onclick="change_code()" style="cursor: pointer;top: 20px"></div>
    <p><input type="button" value="登录" onclick="click_login()"><input type="reset" value="重置"></p>
</form>
</body>
</html>


###################################################################################################################
{#<html lang="en">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <title>登陆页面</title>#}
{#</head>#}
{#    <script src="{% static 'js/jquery-1.12.4.min.js' %}"></script>#}
{#<script>#}
{#    function click_login() {#}
{#        $.post(#}
{#            "{% url '/login_ajax' %}",#}
{#            {'user_tel':login_form.user_tel.value,'yzm':login_form.yzm.value},#}
{#            function (data) {#}
{#                if (data.res == 1){#}
{#                    location.href = '{% url "index" %}'#}
{#                }if(data.res == 0){#}
{#                    alert('账号或密码错误')#}
{#                }if(data.res == 2){#}
{#                    alert("验证码输入不正确")#}
{#                }#}
{#            }#}
{#        )#}
{#    }#}
{#</script>#}
{#<script>#}
{#    function change_code() {#}
{#            var img = document.getElementsByTagName("img")[0];#}
{#            img.src='/login/verify_code?'+new Date().getTime()#}
{#        }#}
{#</script>#}
{##}
{#<body style="text-align: center" onload="login_form.username.focus()">#}
{#<form method="post" id="login_form">#}
{#    <p>请输入手机号:<input type="text" name="user_tel"></p>#}
{#    请证明你不是机器人:<input type="text" name="yzm"><div style="margin-top: -24px;margin-left: 365px"><img src="{% url 'generate_code' %}" width="100" height="25" onclick="change_code()" style="cursor: pointer;top: 20px"></div>#}
{#    <p><input type="button" value="登录" onclick="click_login()"><input type="reset" value="重置"></p>#}
{#</form>#}
{#</body>#}
{#</html>#}
{##}
{##}
{#<html lang="en">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <title>登录演示</title>#}
{#    <script src="{% static 'js/jquery-1.12.4.min.js' %}"></script>#}
{#    <script>#}
{#        function get_code() {#}
{#            user_tel = $("#user_tel").val()#}
{#            $.post('/login/get_phone_code/',{'user_tel':user_tel},function (data) {#}
{#                alert(typeof data)#}
{#               if (data.Message=="OK"){#}
{#                   alert('验证码已经发送到您的手机，请注意查收！')#}
{#                   frm_login.login.focus()#}
{#               }#}
{#            },"json")#}
{##}
{#        }#}
{#    </script>#}
{##}
{#</head>#}
{#<body style="text-align: center" onload="frm_login.userName.focus()">#}
{##}
{#<form name="frm_login" method="post" action="/templates/login/register">#}
{#    {%  csrf_token %}#}
{#    <p>请输入手机号：<input type="text" id="user_tel" name="user_tel"></p>#}
{#    <p>{{ errmsg }}</p>#}
{#    <p>请输入手机号码：<input type="tel" id="user_tel" name="user_tel" pattern="^(0|86|17951)?(13[0-9]|15[012356789]|17[0678]|18[0-9]|14[57])[0-9]{8}"/> </p>#}
{#    <p>请输入验证码：#}
{#        <input type="text" name="login" />#}
{#        <input type="button" value="获取手机验证码" onclick="get_code()">#}
{#    </p>#}
{#    <p>{{ code_error }}</p>#}
{#    <p><input type="submit" value="登录"> <input type="reset" value="重置">#}
{#    </p>#}
{#    <p>{{ errmsg }}</p>#}
{#</form>#}
{#</body>#}
{#</html>#}
